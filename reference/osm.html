<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Ordinal data regression using the Ordered Stereotype Model (OSM). — osm • clustord</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Ordinal data regression using the Ordered Stereotype Model (OSM). — osm"><meta name="description" content="Fit a regression model to an ordered factor response. The model is NOT a
logistic or probit model because the link function is not the logit, but the
link function is log-based."><meta property="og:description" content="Fit a regression model to an ordered factor response. The model is NOT a
logistic or probit model because the link function is not the logit, but the
link function is log-based."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">clustord</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/clustordConvergence.html">`clustord Convergence Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/clustordOrdinalModels.html">`clustord` Ordinal Models</a></li>
    <li><a class="dropdown-item" href="../articles/clustordStructureSummary.html">`clustord` Structure Summary</a></li>
    <li><a class="dropdown-item" href="../articles/clustordTutorial.html">`clustord` Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/RegressionwithOSM.html">Regression with the Ordered Stereotype Model (OSM)</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Ordinal data regression using the Ordered Stereotype Model (OSM).</h1>

      <div class="d-none name"><code>osm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit a regression model to an ordered factor response. The model is NOT a
logistic or probit model because the link function is not the logit, but the
link function is log-based.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">osm</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  <span class="va">start</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  <span class="va">subset</span>,</span>
<span>  <span class="va">na.action</span>,</span>
<span>  Hess <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  model <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>a formula expression as for regression models, of the form
response ~ predictors. The response should be a factor (preferably an
ordered factor), which will be interpreted as an ordinal response, with
levels ordered as in the factor. The model must have an intercept: attempts
to remove one will lead to a warning and be ignored. An offset may be used.
See the documentation of formula for other details.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a data frame, list or environment in which to interpret the
variables occurring in <code>formula</code>.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>optional case weights in fitting. Default to 1.</p></dd>


<dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>initial values for the parameters. See the Details section for
information about this argument.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments to be passed to optim, most often a control
argument.</p></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>expression saying which subset of the rows of the data should
be used in the fit. All observations are included by default.</p></dd>


<dt id="arg-na-action">na.action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>a function to filter missing data.</p></dd>


<dt id="arg-hess">Hess<a class="anchor" aria-label="anchor" href="#arg-hess"></a></dt>
<dd><p>logical for whether the Hessian (the observed information matrix)
should be returned.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>logical for whether the model matrix should be returned.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>"osm"</code>.  This has components</p>
<p><code>beta</code> the coefficients of the covariates, with NO intercept.</p>
<p><code>mu</code> the intercepts for the categories.</p>
<p><code>phi</code> the score parameters for the categories (restricted to be
  ordered).</p>
<p><code>deviance</code> the residual deviance.</p>
<p><code>fitted.values</code> a matrix of fitted values, with a column for each
  level of the response.</p>
<p><code>lev</code> the names of the response levels.</p>
<p><code>terms</code> the <code>terms</code> structure describing the model.</p>
<p><code>df.residual</code> the number of residual degrees of freedom, calculated
  using the weights.</p>
<p><code>edf</code> the (effective) number of degrees of freedom used by the model</p>
<p><code>n, nobs</code> the (effective) number of observations, calculated using the
  weights.</p>
<p><code>call</code> the matched call.</p>
<p><code>convergence</code> the convergence code returned by <code>optim</code>.</p>
<p><code>niter</code> the number of function and gradient evaluations used by
  <code>optim</code>.</p>
<p><code>eta</code></p>
<p><code>Hessian</code> (if <code>Hess</code> is true).  Note that this is a numerical
  approximation derived from the optimization proces.</p>
<p><code>model</code> (if <code>model</code> is true), the model used in the fitting.</p>
<p><code>na.action</code> the NA function used</p>
<p><code>xlevels</code> factor levels from any categorical predictors</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function should be used in a very similar way to <code><a href="https://rdrr.io/pkg/MASS/man/polr.html" class="external-link">MASS::polr</a></code>, and
some of the arguments are the same as <code>polr</code>, but the ordinal model used
here is less restrictive in its assumptions than the proportional odds model.
However, it is still parsimonious i.e. it uses only a small number of
additional parameters compared with the proportional odds model.</p>
<p>This model is the <em>ordered stereotype</em> model (Anderson 1984,
Agresti 2010)</p>
<p>It is more flexible than the proportional odds model but only adds a handful
of additional parameters. It is not a cumulative model, being instead defined
in terms of the relationships between each of the higher categories and the
lowest category that is treated as the reference category.</p>
<p>Each of the higher categories has its own intercept term, mu_k, which is
similar to the zeta parameters in <code>polr</code>, but in the OSM each higher
category also has its own scaling parameter, phi_k, which adjusts the effect
of the covariates on the response. This allows the effect of the covariates
on the response to be slightly different for each category of the response,
thus making the model more flexible than the proportional odds model.</p>
<p>The final set of parameters are coefficients for each of the covariates, and
these are equivalent to the coefs in <code>polr</code>. Higher or more positive
values of the coefficients increases the probability of the response being in
the higher categories, and lower or more negative values of the coefficients
increase the probability of the response being in the lower categories.</p>
<p>The overall model takes the following form:</p>
<p>log(P(Y = k | X)/P(Y = 1 | X)) = mu_k + phi_k*beta_vec^T x_vec</p>
<p>for k = 2, ..., q, where x_vec is the vector of covariates for the
observation Y.</p>
<p>mu_1 is fixed at 0 for identifiability of the model, and the phi_k parameters
are constrained to be ordered (giving the model its name) in the following
way:</p>
<p>0 = phi_1 &lt;= phi_2 &lt;= ... &lt;= phi_k &lt;= ... &lt;= phi_q = 1.</p>
<p>(The unordered stereotype model restricts phi_1 and phi_q but allows the
remaining phi_k to be in any order, and this is suitable for fitting the
model for nominal data. However, this package does not provide that option,
as it is already available in other packages which can fit the stereotype
model.)</p>
<p>After fitting the model, the estimated values of the intermediate phi_k
values indicate a suitable numerical spacing of the ordinal response
categories that is based on the data. The spacings indicate how much distinct
information each of the corresponding levels provide. For example, if you
have five response categories and the fitted phi values are <code>(0, 0.04,
0.6, 0.62, 1)</code> then this indicates that levels 1 and 2 provide very similar
information about the effect of the covariates on the response, and levels 3
and 4 provide very similar information as each other. The meaning of this is
that you could simplify the response by combining levels 1 and 2 and
combining levels 3 and 4 (i.e. reduce the levels to 1, 3 and 5) and you would
still be able to estimate the beta coefficients with similar accuracy.</p>
<p>Another use for the phi_k values is that if you want to carry out further
analysis of the response, treating it as a numerical variable, then the phi
values are a better choice of numerical values for the response categories
than the default values 1 to q.</p>
<p><strong><code>start</code></strong> argument values: <code>start</code> is a vector of start
values for estimating the model parameters.</p>
<p>The first part of the <code>start</code> vector is starting values for the
coefficients of the covariates, the second part is starting values for the mu
values (per-category intercepts), and the third part is starting values for
the raw parameters used to construct the phi values.</p>
<p>The length of the vector is [number of covariate terms] + [number of
categories in response variable - 1] + [number of categories in response
variable - 2]. Every one of the values can take any real value.</p>
<p>The second part is the starting values for the mu_k per-category intercept
parameters, and since mu_1 is fixed at 0 for identifiability, the number of
non-fixed mu_k parameters is one fewer than the number of categories.</p>
<p>The third part of the starting vector is a re-parametrization used to
construct starting values for the estimated phi parameters such that the phi
parameters observe the ordering restriction of the ordered stereotype model,
but the raw parameters are not restricted which makes it easier to optimise
over them. phi_1 is always 0 and phi_q is always 1 (where q is the number of
response categories). If the raw parameters are u_2 up to u_(q-1), then phi_2
is constructed as expit(u_2), phi_3 is expit(u_2 + exp(u_3)), phi_4 is
expit(exp(u_3) + exp(u_4)) etc. which ensures that the phi_k values are
non-decreasing.</p>
<p>This code was adapted from file MASS/R/polr.R
copyright (C) 1994-2013 W. N. Venables and B. D. Ripley
Use of transformed intercepts contributed by David Firth
The osm and osm.fit functions were written by Louise McMillan, 2020.</p>
<p>This program is free software; you can redistribute it and/or modify it under
the terms of the GNU General Public License as published by the Free Software
Foundation; either version 2 or 3 of the License (at your option).</p>
<p>This program is distributed in the hope that it will be useful, but WITHOUT
ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more
details.</p>
<p>A copy of the GNU General Public License is available at
http://www.r-project.org/Licenses/</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Agresti, A. (2010). <em>Analysis of ordinal categorical data</em> (Vol. 656). John Wiley &amp; Sons.</p>
<p>Anderson, J. A. (1984). Regression and ordered categorical variables. <em>Journal of the Royal Statistical Society: Series B (Methodological)</em>, 46(1), 1-22.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>[MASS::polr()]</p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Louise McMillan, Daniel Fernández Martínez, Ying Cui, Eleni Matechou.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

