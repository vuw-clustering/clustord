<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>`clustord` Ordinal Models • clustord</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="`clustord` Ordinal Models">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">clustord</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/clustordOrdinalModels.html">`clustord` Ordinal Models</a></li>
    <li><a class="dropdown-item" href="../articles/clustordStructureSummary.html">`clustord` Structure Summary</a></li>
    <li><a class="dropdown-item" href="../articles/clustordTutorial.html">`clustord` Tutorial</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>`clustord` Ordinal Models</h1>
                        <h4 data-toc-skip class="author">Louise
McMillan</h4>
            
            <h4 data-toc-skip class="date">2024-11-18</h4>
      

      <div class="d-none name"><code>clustordOrdinalModels.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="tldr">
<strong>TL:DR</strong><a class="anchor" aria-label="anchor" href="#tldr"></a>
</h2>
<p>The proportional-odds model is named <code>"POM"</code> in the
<code><a href="../reference/clustord.html">clustord()</a></code> model argument. It is the most commonly-used
model for ordinal data analysis, and it is the simplest, in that it has
the fewest parameters and a consistent pattern for all categories of the
ordinal response variables.</p>
<p>The ordered stereotype model is named <code>"OSM"</code> in the
<code><a href="../reference/clustord.html">clustord()</a></code> model argument. Compared with the
proportional-odds model, it has one additional parameter for every
category/level of the ordinal response variable. These additional
parameters, plus its non-cumulative structure, make it much more
flexible. Use the OSM if you think that your ordinal data may be very
heterogeneous in terms of the patterns of different categories of the
response variables.</p>
<p>The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="monospace">𝚙𝚑𝚒</mtext><mi>k</mi></msub><annotation encoding="application/x-tex">\texttt{phi}_k</annotation></semantics></math>
score parameters for the response categories
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
indicate how much information is available in each response category. If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="monospace">𝚙𝚑𝚒</mtext><mi>k</mi></msub><annotation encoding="application/x-tex">\texttt{phi}_k</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="monospace">𝚙𝚑𝚒</mtext><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">\texttt{phi}_{k+1}</annotation></semantics></math>
are very similar (within 0.1 of each other) then that indicates that
response categories
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k+1</annotation></semantics></math>
do not provide much information about any clustering structure, which
means you could simplify your data by combining those two response
categories without having much effect on the results of the
analysis.</p>
<p>You can also use the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="monospace">𝚙𝚑𝚒</mtext><mi>k</mi></msub><annotation encoding="application/x-tex">\texttt{phi}_k</annotation></semantics></math>
scores from the OSM as a data-driven numerical encoding of your ordinal
response categories that is better than simply numbering the categories
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">1, 2, \ldots, q</annotation></semantics></math>
and then carry out analysis using methods for numerical data, such as
k-means (Lloyd, 1982 and MacQueen, 1967).</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>For this package, we assume that you have a dataset of ordinal data.
The most common form of this is survey data, such as you might get by
asking participants to ask a series of questions with Likert-scale
answers (for example, ranking from 1 = “Strongly Disagree” to 5 =
“Strongly Agree”).</p>
<p><img src="vignette_fig%2Fsurvey_table1.png" width="70%" style="display: block; margin: auto;"></p>
<p>We will refer to the data matrix as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐘</mi><annotation encoding="application/x-tex">\bm{Y}</annotation></semantics></math>.
We index the rows of the data matrix with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and the columns of the data matrix with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>,
so an individual response value is defined as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">Y_{ij}</annotation></semantics></math>.
The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi><annotation encoding="application/x-tex">q</annotation></semantics></math>
categories of each response variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">Y_{ij}</annotation></semantics></math>
are indexed with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>,
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">k = 1, \dots, q</annotation></semantics></math>.</p>
<p>There are three broad types of clustering: row clustering, column
clustering and biclustering. Within each of these, there are multiple
possible clustering structures. These are discussed in detail in the
<em><code>clustord</code> Tutorial</em> vignette, and summarised in the
<em>Clustering Structure Summary</em> vignette.</p>
<p>If there are row clusters, they are indexed with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>
and if there are column clusters they are indexed with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>.</p>
<p>This vignette discusses the two types of ordinal models that are
available in <code>clustord</code>: the <strong>proportional-odds model
(POM)</strong> and the <strong>ordered stereotype model
(OSM)</strong>.</p>
</div>
<div class="section level2">
<h2 id="proportional-odds-model-pom">Proportional-odds model (POM)<a class="anchor" aria-label="anchor" href="#proportional-odds-model-pom"></a>
</h2>
<p>The first model is the proportional-odds model (Agresti, 2000). This
is the most widely-used ordinal model, and the simplest. The model is
more easily recognisable as a regression model:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">logit</mtext><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>≤</mo><mi>k</mi><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>𝐱</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac displaystyle="true"><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>≤</mo><mi>k</mi><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>𝐱</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>&gt;</mo><mi>k</mi><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>𝐱</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>μ</mi><mi>k</mi></msub><mo>−</mo><msup><mi>𝛃</mi><mi>T</mi></msup><mi>𝐱</mi><mspace width="0.278em"></mspace><mspace width="0.278em"></mspace><mtext mathvariant="normal">for</mtext><mspace width="0.278em"></mspace><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>q</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">
\mbox{logit}P(Y \leq k \,|\, \bm{x}) = \log\left(\dfrac{P(Y \leq k \,|\, \bm{x})}{P(Y &gt; k \,|\, \bm{x})}\right) = \mu_k - \bm{\beta}^T\bm{x} \; \; \mbox{for}\; k = 1, \dots, q-1
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\mu_k</annotation></semantics></math>
is the intercept parameter for response category
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛃</mi><annotation encoding="application/x-tex">\bm{\beta}</annotation></semantics></math>
are the coefficients controlling the effect of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐱</mi><annotation encoding="application/x-tex">\bm{x}</annotation></semantics></math>
on the response,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>.
The model is named “proportional-odds” because the coefficients do not
depend on the response category,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.
That is, the effect of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐱</mi><annotation encoding="application/x-tex">\bm{x}</annotation></semantics></math>
is the same for every single category of the response. Thus, the number
of coefficients is only one more than the number of covariates.</p>
<p>This is also a <strong>cumulative</strong> ordinal model in that it
is expressed as the probability of obtaining a given response category
or lower, relative to the probability of getting any of the higher
response categories. Along with the coefficients staying the same for
all categories, this is the other part of how this model enforces
similar patterns of effects for every response category.</p>
<p>The proportional-odds clustering forms in <code>clustord</code> were
introduced in Matechou et al. (2016). Considering cell
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(i,j)</annotation></semantics></math>
in the data matrix of responses, where if row
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
is in row cluster
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>
and/or column
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
is in column
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
then the model has this general shape:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac displaystyle="true"><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>≤</mo><mi>k</mi><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>i</mi><mo>∈</mo><mi>r</mi><mo>,</mo><mspace width="0.278em"></mspace><mi>j</mi><mo>∈</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>&gt;</mo><mi>k</mi><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>i</mi><mo>∈</mo><mi>r</mi><mo>,</mo><mspace width="0.278em"></mspace><mi>j</mi><mo>∈</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>μ</mi><mi>k</mi></msub><mo>−</mo><msub><mi>η</mi><mrow><mi>r</mi><mi>c</mi><mi>i</mi><mi>j</mi></mrow></msub><mspace width="0.278em"></mspace><mspace width="0.278em"></mspace><mtext mathvariant="normal">for</mtext><mspace width="0.278em"></mspace><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>q</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">
\log\left(\dfrac{P(Y_{ij} \leq k \,|\, i \in r,\; j \in c)}{P(Y_{ij} &gt; k \,|\, i \in r,\; j \in c)}\right) = \mu_k - \eta_{rcij} \; \; \mbox{for}\; k = 1, \dots, q-1
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\mu_k</annotation></semantics></math>
is a parameter that controls the default probabilities of the different
response categories in the absence of clustering, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>η</mi><mrow><mi>r</mi><mi>c</mi><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\eta_{rcij}</annotation></semantics></math>
is the remaining part of the linear predictor.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>η</mi><mrow><mi>r</mi><mi>c</mi><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\eta_{rcij}</annotation></semantics></math>
is the part of the model that determines the clustering structure, and
it is the same in both the proportional-odds model and the ordered
stereotype model within <code>clustord</code>.</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>η</mi><mrow><mi>r</mi><mi>c</mi><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\eta_{rcij}</annotation></semantics></math>
is subtracted from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\mu_k</annotation></semantics></math>,
rather than added, so that if a parameter within
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>η</mi><mrow><mi>r</mi><mi>c</mi><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\eta_{rcij}</annotation></semantics></math>
is positive then that corresponds to a higher probability of obtaining
higher response categories (whereas if it were added, positive effects
would lead to a higher probability of obtaining lower response
categories).</p>
<p>The logit notation above is the most compact way of expressing this
model, but alternatively we can express it in terms of the probability,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">\theta_{ijk}</annotation></semantics></math>,
of getting a single response category,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>,
in cell
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">Y_{ij}</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>i</mi><mo>∈</mo><mi>r</mi><mo>,</mo><mspace width="0.278em"></mspace><mi>j</mi><mo>∈</mo><mi>c</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mfrac displaystyle="true"><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mi>k</mi></msub><mo>−</mo><msub><mi>η</mi><mrow><mi>r</mi><mi>c</mi><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mi>k</mi></msub><mo>−</mo><msub><mi>η</mi><mrow><mi>r</mi><mi>c</mi><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mi>k</mi><mo>=</mo><mn>1</mn></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mfrac displaystyle="true"><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mi>k</mi></msub><mo>−</mo><msub><mi>η</mi><mrow><mi>r</mi><mi>c</mi><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mi>k</mi></msub><mo>−</mo><msub><mi>η</mi><mrow><mi>r</mi><mi>c</mi><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>−</mo><mfrac displaystyle="true"><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>η</mi><mrow><mi>r</mi><mi>c</mi><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>η</mi><mrow><mi>r</mi><mi>c</mi><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mn>1</mn><mo>&lt;</mo><mi>k</mi><mo>&lt;</mo><mi>q</mi></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn><mo>−</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>q</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>θ</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mi>k</mi><mo>=</mo><mi>q</mi></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\theta_{ijk} \,|\, i\in r,\;j \in c = 
\begin{cases}
\dfrac{\exp(\mu_k - \eta_{rcij})}{1+\exp(\mu_k - \eta_{rcij})} &amp; k = 1\\[10pt]
\dfrac{\exp(\mu_k - \eta_{rcij})}{1+\exp(\mu_k - \eta_{rcij})} - \dfrac{\exp(\mu_{k-1} - \eta_{rcij})}{1+\exp(\mu_{k-1} - \eta_{rcij})} &amp; 1 &lt; k &lt; q \\[10pt]
1 - \sum_{k=1}^{q-1} \theta_{ijk} &amp; k = q
\end{cases}
</annotation></semantics></math></p>
<p>These are some of the potential clustering structures within
<code>clustord</code>, expressed in POM form:</p>
<p>Column clustering and biclustering can similarly include covariates,
in the same way as row clustering can. Note that because the
coefficient/covariate structure of including covariates is the same in
the clustering models regardless of whether the covariates are attached
to the rows
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐱</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\bm{x}_i</annotation></semantics></math>)
or the columns
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐰</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\bm{w}_j</annotation></semantics></math>),
the <code>clustord</code> package combines their coefficients into one
single <code>cov</code> parameter vector, with the order of the
coefficients corresponding to the order in which they’re included in the
formula provided to <code><a href="../reference/clustord.html">clustord()</a></code>.</p>
<div style="page-break-after: always;"></div>
</div>
<div class="section level2">
<h2 id="ordered-stereotype-model">Ordered stereotype model<a class="anchor" aria-label="anchor" href="#ordered-stereotype-model"></a>
</h2>
<p>The second model is the ordered stereotype model (introduced by
Anderson, 1984 and described in Agresti, 2000). This is a more flexible
model than the proportional-odds model. It has one additional set of
parameters,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>ϕ</mi><mi>k</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{\phi_k\}</annotation></semantics></math>,
and a non-cumulative logit structure. This is the regression model form:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac displaystyle="true"><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>=</mo><mi>k</mi><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>𝐱</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>=</mo><mn>1</mn><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>𝐱</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>μ</mi><mi>k</mi></msub><mo>+</mo><msub><mi>ϕ</mi><mi>k</mi></msub><msup><mi>𝛃</mi><mi>T</mi></msup><mi>𝐱</mi><mspace width="0.278em"></mspace><mspace width="0.278em"></mspace><mtext mathvariant="normal">for</mtext><mspace width="0.278em"></mspace><mi>k</mi><mo>=</mo><mn>2</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">
\log\left(\dfrac{P(Y = k \,|\, \bm{x})}{P(Y = 1 \,|\, \bm{x})}\right) = \mu_k + \phi_k\bm{\beta}^T\bm{x} \; \; \mbox{for}\; k = 2, \dots, q
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛃</mi><annotation encoding="application/x-tex">\bm{\beta}</annotation></semantics></math>
are the coefficients controlling the effect of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐱</mi><annotation encoding="application/x-tex">\bm{x}</annotation></semantics></math>
on the response,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>.</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\mu_1</annotation></semantics></math>
is set to 0 to ensure identifiability and the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϕ</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\phi_k</annotation></semantics></math>
parameters are constrained to be ordered:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>=</mo><msub><mi>ϕ</mi><mn>1</mn></msub><mo>≤</mo><msub><mi>ϕ</mi><mn>2</mn></msub><mo>≤</mo><mi>…</mi><mo>≤</mo><msub><mi>ϕ</mi><mi>q</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 = \phi_1 \leq \phi_2 \leq \dots \leq \phi_q = 1</annotation></semantics></math>.
(The non-ordered stereotype model lacks this constraint, and can be used
to model nominal data.)</p>
<p>In the ordered stereotype model, the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϕ</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\phi_k</annotation></semantics></math>
parameters modify the effect of the covariate on the response so that
the effect varies between response categories. Moreover, the model is
non-cumulative, so the pattern of response category 3, relative to
category 1, can be different than the pattern of response category 2,
relative to category 1.</p>
<p>The ordered stereotype clustering forms in <code>clustord</code> were
defined in Fernández et al. (2016) and Fernández et al. (2019). Again
for cell
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(i,j)</annotation></semantics></math>
in the data matrix of responses, if row
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
is in row cluster
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>
and/or column
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
is in column
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
then the model has this general shape:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac displaystyle="true"><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>k</mi><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>i</mi><mo>∈</mo><mi>r</mi><mo>,</mo><mspace width="0.278em"></mspace><mi>j</mi><mo>∈</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>i</mi><mo>∈</mo><mi>r</mi><mo>,</mo><mspace width="0.278em"></mspace><mi>j</mi><mo>∈</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>μ</mi><mi>k</mi></msub><mo>+</mo><msub><mi>ϕ</mi><mi>k</mi></msub><msub><mi>η</mi><mrow><mi>r</mi><mi>c</mi><mi>i</mi><mi>j</mi></mrow></msub><mspace width="0.278em"></mspace><mspace width="0.278em"></mspace><mtext mathvariant="normal">for</mtext><mspace width="0.278em"></mspace><mi>k</mi><mo>=</mo><mn>2</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">
\log\left(\dfrac{P(Y_{ij} = k \,|\, i \in r,\; j \in c)}{P(Y_{ij} = 1 \,|\, i \in r,\; j \in c)}\right) = \mu_k + \phi_k\eta_{rcij} \; \; \mbox{for}\; k = 2, \dots, q
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\mu_k</annotation></semantics></math>
is a parameter that controls the default probabilities of the different
response categories in the absence of clustering,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϕ</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\phi_k</annotation></semantics></math>
is the score parameter for category
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>η</mi><mrow><mi>r</mi><mi>c</mi><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\eta_{rcij}</annotation></semantics></math>
is the remaining part of the linear predictor.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>η</mi><mrow><mi>r</mi><mi>c</mi><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\eta_{rcij}</annotation></semantics></math>
is the same as in the proportional-odds model.</p>
<p>As for POM, the notation above is the most compact way of expressing
the OSM, but alternatively we can express it in terms of the
probability,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">\theta_{ijk}</annotation></semantics></math>,
of getting a single response category,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>,
in cell
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">Y_{ij}</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>i</mi><mo>∈</mo><mi>r</mi><mo>,</mo><mspace width="0.278em"></mspace><mi>j</mi><mo>∈</mo><mi>c</mi><mo>=</mo><mfrac displaystyle="true"><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mi>k</mi></msub><mo>+</mo><msub><mi>ϕ</mi><mi>k</mi></msub><msub><mi>η</mi><mrow><mi>r</mi><mi>c</mi><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><munderover><mo>∑</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>q</mi></munderover><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mi>l</mi></msub><mo>+</mo><msub><mi>ϕ</mi><mi>l</mi></msub><msub><mi>η</mi><mrow><mi>r</mi><mi>c</mi><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">
\theta_{ijk} \,|\, i\in r,\;j \in c = 
\dfrac{\exp(\mu_k + \phi_k\eta_{rcij})}{\sum_{l=1}^q \exp(\mu_l + \phi_l \eta_{rcij})} k = 1, \dots, q
</annotation></semantics></math></p>
<p>These are some of the potential clustering structures within
<code>clustord</code>, expressed in OSM form:</p>
<p>As for POM, because the coefficient/covariate structure of including
covariates is the same in the clustering models regardless of whether
the covariates are attached to the rows
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐱</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\bm{x}_i</annotation></semantics></math>)
or the columns
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐰</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\bm{w}_j</annotation></semantics></math>),
the <code>clustord</code> package combines their coefficients into one
single <code>cov</code> parameter vector, with the order of the
coefficients corresponding to the order in which they’re included in the
formula provided to <code><a href="../reference/clustord.html">clustord()</a></code>.</p>
<p>Note that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>η</mi><mrow><mi>r</mi><mi>c</mi><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\eta_{rcij}</annotation></semantics></math>
takes the same forms for POM and OSM even though the overall
distribution shapes differ.</p>
</div>
<div class="section level2">
<h2 id="a-note-about-notation">A note about notation<a class="anchor" aria-label="anchor" href="#a-note-about-notation"></a>
</h2>
<p>If you are looking at the cited journal articles by Pledger and
Arnold (2014), Matechou et al. (2016), and Fernández et al. (2016 and
2019), the notation in those is slightly different than the notation
used in this tutorial. The package and tutorial notation was changed to
reduce confusion between the parameters in the row clustering and column
clustering models.</p>
<p>Table 1 is a glossary of the notation used in <code>clustord</code>
and the corresponding notation used in the articles.</p>
<p>The rest of the parameters retain the same names in this tutorial and
the cited references.</p>
<p>Note also that, although it is theoretically possible in this model
structure to add
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>r</mi></msub><annotation encoding="application/x-tex">\alpha_r</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\alpha_i</annotation></semantics></math>
to the same model, ie. row cluster effects <strong>and</strong>
individual row effects, <code>clustord</code> does not allow this, and
will warn you if you try to use <code>Y ~ ROWCLUST + ROW</code> or
similar formulae. And the biclustering model, which has
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>r</mi></msub><annotation encoding="application/x-tex">\alpha_r</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>c</mi></msub><annotation encoding="application/x-tex">\beta_c</annotation></semantics></math>,
does not allow either individual row or individual column effects,
partly because this would introduce too many parameters and be too
difficult to fit correctly.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Agresti, A. (2010). <em>Analysis of ordinal categorical data</em>.
Vol. 656, John Wiley &amp; Sons.</p>
<p>Anderson, J. A. (1984). Regression and ordered categorical variables.
<em>Journal of the Royal Statistical Society – Series B
(Methodological)</em>, pp. 1–30.</p>
<p>Fernández, D., Arnold., R. and Pledger, S. (2016). Mixture-based
clustering for the ordered stereotype model. <em>Computational
Statistics &amp; Data Analysis</em>, <strong>93</strong>, pp. 46–75.</p>
<p>Fernández, D., Arnold, R., Pledger, S., Liu, I., &amp; Costilla, R.
(2019). Finite mixture biclustering of discrete type multivariate data.
<em>Advances in Data Analysis and Classification</em>,
<strong>13</strong>, pp. 117–143.</p>
<p>Lloyd, S. P. (1982). Least squares quantization in PCM. <em>IEEE
Transactions on Information Theory</em>, <strong>28</strong>(2),
pp. 129–137.</p>
<p>MacQueen, J. B. (1967). Some Methods for classification and Analysis
of Multivariate Observations. <em>Proceedings of 5th Berkeley Symposium
on Mathematical Statistics and Probability. University of California
Press</em>, <strong>1</strong>(14), pp. 281–297.</p>
<p>Matechou, E., Liu, I., Fernández, D. Farias, M., and Gjelsvik, B.
(2016). Biclustering models for two-mode ordinal data.
<em>Psychometrika</em>, <strong>81</strong>, pp. 611–624.</p>
<p>Pledger, S. and Arnold, R. (2014). Multivariate methods using
mixtures: Correspondence analysis, scaling and pattern-detection.
<em>Computational Statistics and Data Analysis</em> <strong>71</strong>,
pp. 241–261.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Louise McMillan, Daniel Fernández Martínez, Ying Cui, Eleni Matechou.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
