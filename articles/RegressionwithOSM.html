<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Regression with the Ordered Stereotype Model (OSM) ‚Ä¢ clustord</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Regression with the Ordered Stereotype Model (OSM)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">clustord</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/clustordConvergence.html">`clustord Convergence Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/clustordOrdinalModels.html">`clustord` Ordinal Models</a></li>
    <li><a class="dropdown-item" href="../articles/clustordStructureSummary.html">`clustord` Structure Summary</a></li>
    <li><a class="dropdown-item" href="../articles/clustordTutorial.html">`clustord` Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/RegressionwithOSM.html">Regression with the Ordered Stereotype Model (OSM)</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Regression with the Ordered Stereotype Model (OSM)</h1>
                        <h4 data-toc-skip class="author">Louise
McMillan</h4>
            
      

      <div class="d-none name"><code>RegressionwithOSM.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>clustord</code> package is primarily designed for
clustering ordinal data, but you can also use it to carry out regression
on ordinal response data using the Ordered Stereotype Model (OSM) using
the <code><a href="../reference/osm.html">osm()</a></code> function.</p>
<p>The proportional odds model (POM) is the other ordinal model
available for clustering in <code>clustord</code>, but a regression
function is not provided for that, because the <code>MASS</code> package
already contains such a function, <code>polr()</code>. The
<code><a href="../reference/osm.html">osm()</a></code> function in <code>clustord</code> is designed to be
similar to the <code>polr()</code> function, with similar arguments and
some of the same outputs.</p>
<p>In order to demonstrate the use of the <code><a href="../reference/osm.html">osm()</a></code> function,
we will first load the <code>arthritis</code> dataset from the
<code>multgee</code> package. This dataset contains self-assessment
scores from rheumatoid arthritis sufferers at an initial baseline
assessment and at several follow-up times.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vuw-clustering.github.io/clustord/">clustord</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/AnestisTouloumis/multgee" class="external-link">multgee</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">arthritis</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id y sex age trt baseline time</span></span>
<span><span class="co">#&gt; 1  1 4   2  54   2        2    1</span></span>
<span><span class="co">#&gt; 2  1 5   2  54   2        2    3</span></span>
<span><span class="co">#&gt; 3  1 5   2  54   2        2    5</span></span>
<span><span class="co">#&gt; 4  2 4   1  41   1        3    1</span></span>
<span><span class="co">#&gt; 5  2 4   1  41   1        3    3</span></span>
<span><span class="co">#&gt; 6  2 4   1  41   1        3    5</span></span></code></pre></div>
<p>The <code>y</code> variable is the self-assessment score, which will
be our ordinal response. We will convert it to a factor, which is
necessary for the analysis. Since the response is already encoded as
values 1 to 5, we do not need to change the default factor levels.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">arthritis</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">arthritis</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="ordered-stereotype-model-definition">Ordered Stereotype Model definition<a class="anchor" aria-label="anchor" href="#ordered-stereotype-model-definition"></a>
</h2>
<p>We will define the ordered stereotype model for an observation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
with response value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">Y_i</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi><annotation encoding="application/x-tex">q</annotation></semantics></math>
levels indexed by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">k = 1, \dots, q</annotation></semantics></math>.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">Y_i</annotation></semantics></math>
depends on covariates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùêó</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\bm{X}_i</annotation></semantics></math>.
The ordered sterotype model takes the form
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac displaystyle="true"><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><mi>k</mi><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><msub><mi>ùê±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><msub><mi>ùê±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Œº</mi><mi>k</mi></msub><mo>+</mo><msub><mi>œï</mi><mi>k</mi></msub><msup><mi>ùõÉ</mi><mi>T</mi></msup><msub><mi>ùê±</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">
\log\left(\dfrac{P(Y_i = k \,|\, \bm{x}_i)}{P(Y_i = 1 \,|\, \bm{x}_i)} \right) = \mu_k + \phi_k \bm{\beta}^T\bm{x}_i
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œº</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\mu_1</annotation></semantics></math>
is fixed at 0 for identifiability and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>=</mo><msub><mi>œï</mi><mn>1</mn></msub><mo>‚â§</mo><mi>‚Ä¶</mi><mo>‚â§</mo><msub><mi>œï</mi><mi>k</mi></msub><mo>‚â§</mo><mi>‚Ä¶</mi><mo>‚â§</mo><msub><mi>œï</mi><mi>q</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 = \phi_1 \leq \ldots \leq \phi_k \leq \ldots \leq \phi_q = 1</annotation></semantics></math>.
The restriction on the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œï</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\phi_k</annotation></semantics></math>
values is what makes this the <strong>ordered</strong> stereotype
model.</p>
<p>The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùõÉ</mi><annotation encoding="application/x-tex">\bm{\beta}</annotation></semantics></math>
values are the coefficients of the covariates, as in a linear regression
model, except here they change the probability of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">Y_i</annotation></semantics></math>
taking different levels. If a single coefficient is positive, it
increases the probability of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">Y_i</annotation></semantics></math>
taking higher levels, and if it is negative it increases the probability
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">Y_i</annotation></semantics></math>
taking lower levels.</p>
<p>It is possible to have a more flexible model where there are separate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùõÉ</mi><annotation encoding="application/x-tex">\bm{\beta}</annotation></semantics></math>
coefficients for each level of the response, but that is not available
in this package.</p>
<p>Note that this is <strong>not</strong> a cumulative model, nor is it
a logistic model, because the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>log</mo><annotation encoding="application/x-tex">\log</annotation></semantics></math>
function on the left hand side of the model equation is not a logit. By
contrast, the proportional odds model is a cumulative logit model:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac displaystyle="true"><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>‚â§</mo><mi>k</mi><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><msub><mi>ùê±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>&gt;</mo><mi>k</mi><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><msub><mi>ùê±</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Œº</mi><mi>k</mi></msub><mo>‚àí</mo><msup><mi>ùõÉ</mi><mi>T</mi></msup><msub><mi>ùê±</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">
\log\left(\dfrac{P(Y_i \leq k \,|\, \bm{x}_i)}{P(Y_i &gt; k \,|\, \bm{x}_i)} \right) = \mu_k - \bm{\beta}^T\bm{x}_i
</annotation></semantics></math></p>
<p>Note that the minus sign in this form of the proportional odds model
ensures that the coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùõÉ</mi><annotation encoding="application/x-tex">\bm{\beta}</annotation></semantics></math>
have the same effect as in the ordered stereotype model, i.e.¬†that
positive values of the coefficients increase the probability of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">Y_i</annotation></semantics></math>
taking higher levels.</p>
<p>The ordered stereotype model is more flexible than the proportional
odds model partly because the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œï</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\phi_k</annotation></semantics></math>
score parameters change the effect of the coefficients for different
levels of the response, so that the model is not proportional at every
response level. It is also more flexible because it is not a cumulative
model, in that the model is based on the separate relative probability
of any of the upper levels compared with the baseline reference level.
That is, the ratio in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>log</mo><annotation encoding="application/x-tex">\log</annotation></semantics></math>
part is a ratio between level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
and level 1, without reference to any of the other levels.</p>
<p>Therefore, if you have data that do not fit the proportionality
requirements of the proportional odds model, fitting the ordered
stereotype model provides more flexibility and only increases the number
of independent parameters by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>‚àí</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">q - 2</annotation></semantics></math>
(because
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œï</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\phi_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œï</mi><mi>q</mi></msub><annotation encoding="application/x-tex">\phi_q</annotation></semantics></math>
are already fixed at 0 and 1).</p>
</div>
<div class="section level2">
<h2 id="ordered-stereotype-model-fitting">Ordered Stereotype Model fitting<a class="anchor" aria-label="anchor" href="#ordered-stereotype-model-fitting"></a>
</h2>
<p>We can fit the ordered stereotype model using a standard regression
call, specifying the required formula and the dataset to use. We will
test a model in which the response, i.e.¬†the self-assessment score, is
dependent on the baseline self-assessment score and the patient‚Äôs sex
and age.</p>
<p>Since the dataset has multiple rows for each patient, containing
self-assessment scores at different follow-up time points (i.e.¬†it is a
longitudinal dataset), we will select only one of these time points for
our analysis, using the <code>subset</code> argument of the
<code><a href="../reference/osm.html">osm()</a></code> function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/osm.html">osm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">baseline</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span>, data<span class="op">=</span><span class="va">arthritis</span>, subset <span class="op">=</span> <span class="op">(</span><span class="va">time</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; osm(formula = y ~ baseline + sex + age, data = arthritis, subset = (time == </span></span>
<span><span class="co">#&gt;     1))</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients beta:</span></span>
<span><span class="co">#&gt;   baseline        sex        age </span></span>
<span><span class="co">#&gt;  2.2405222 -0.4876093 -0.0748720 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts mu:</span></span>
<span><span class="co">#&gt;       mu1       mu2       mu3       mu4       mu5 </span></span>
<span><span class="co">#&gt;  0.000000  1.826286  2.663686  1.918819 -1.812439 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Score parameters phi:</span></span>
<span><span class="co">#&gt;      phi1      phi2      phi3      phi4      phi5 </span></span>
<span><span class="co">#&gt; 0.0000000 0.2362019 0.2919803 0.5367646 1.0000000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual Deviance: 732.5564 </span></span>
<span><span class="co">#&gt; AIC: 752.5564 </span></span>
<span><span class="co">#&gt; BIC: 789.5609 </span></span>
<span><span class="co">#&gt; (3 observations deleted due to missingness)</span></span>
<span><span class="co">#&gt; Warning: did not converge as iteration limit reached</span></span></code></pre></div>
<p>Notice that the output of this initial fit includes a warning
message:
<code>Warning: did not converge as iteration limit reached</code>. This
warning indicates that the <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim()</a></code> function inside
<code><a href="../reference/osm.html">osm()</a></code>, which is used to fit the model, did not manage to
converge to a solution.</p>
<p>We therefore need to refit the model allowing <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim()</a></code> to
run for more iterations, to ensure convergence. We can do this by
passing in the <code>control</code> argument for <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim()</a></code>,
which is a list of control parameters for <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim()</a></code>. The only
control parameter we will change is the upper limit on the number of
iterations, <code>maxit</code>. The default is 100, and we will increase
it to 5000.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/osm.html">osm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">baseline</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span>, data<span class="op">=</span><span class="va">arthritis</span>, </span>
<span>           subset <span class="op">=</span> <span class="op">(</span><span class="va">time</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxit<span class="op">=</span><span class="fl">5000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; osm(formula = y ~ baseline + sex + age, data = arthritis, control = list(maxit = 5000), </span></span>
<span><span class="co">#&gt;     subset = (time == 1))</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients beta:</span></span>
<span><span class="co">#&gt;     baseline          sex          age </span></span>
<span><span class="co">#&gt;  1.860974404  0.811523676 -0.009104044 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts mu:</span></span>
<span><span class="co">#&gt;       mu1       mu2       mu3       mu4       mu5 </span></span>
<span><span class="co">#&gt;  0.000000  1.474043  1.141984 -1.841170 -6.408926 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Score parameters phi:</span></span>
<span><span class="co">#&gt;       phi1       phi2       phi3       phi4       phi5 </span></span>
<span><span class="co">#&gt; 0.00000000 0.01118914 0.23064920 0.64609192 1.00000000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual Deviance: 719.6392 </span></span>
<span><span class="co">#&gt; AIC: 739.6392 </span></span>
<span><span class="co">#&gt; BIC: 776.6436 </span></span>
<span><span class="co">#&gt; (3 observations deleted due to missingness)</span></span></code></pre></div>
<p>Now we have got a converged solution, so we can now move on to
interpreting the results.</p>
<div class="section level3">
<h3 id="covariate-coefficients">Covariate coefficients<a class="anchor" aria-label="anchor" href="#covariate-coefficients"></a>
</h3>
<p>The <code>beta</code> estimates are the estimated coefficients of the
covariates baseline, sex and age. More positive values correspond to a
higher probability of getting high response levels (i.e.¬†in this case,
you‚Äôre more likely to get y = 4 or 5 than 1 or 2), and more negative
values correspond to a higher probability of getting low response levels
(i.e.¬†you‚Äôre more likely to get y = 1 or 2 than 4 or 5).</p>
<p>We see that the coefficient for baseline is 1.94, which indicates
that the baseline score for an individual has a big impact on their
follow-up self assessment score. If the baseline increases by one level,
then that makes it more likely that the follow-up self-assessment score,
y, will also be higher.</p>
<p>We see that the coefficient for sex is 0.84. The reference level, 1,
corresponds to female, and 2 corresponds to male. So male patients are
more likely to have high self-assessment scores than female patients.
But the effect of sex is not as dramatic as the effect of the baseline
score.</p>
<p>Finally, we see that the coefficient for age is -0.0090. This is much
smaller than the effects of baseline or sex. It‚Äôs also slightly
negative. So this indicates that every additional year the patient had
lived at the start of the trial reduced the chances of them having high
follow up scores, but only by a tiny bit.</p>
<p>Overall, the effect sizes suggest that baseline and sex are relevant,
but that age is not particularly important.</p>
</div>
<div class="section level3">
<h3 id="mu-parameters">
<code>mu</code> parameters<a class="anchor" aria-label="anchor" href="#mu-parameters"></a>
</h3>
<p>The <code>mu</code> estimates in the output are, roughly speaking,
the intercept terms for each level of the response. This is why there is
no intercept term amongst the covariate coefficients: it is already
incorporated into the <code>mu</code> parameters. We do not need to
interpret these estimates.</p>
</div>
<div class="section level3">
<h3 id="phi-parameters">
<code>phi</code> parameters<a class="anchor" aria-label="anchor" href="#phi-parameters"></a>
</h3>
<p>The <code>phi</code> estimates in the output are the ‚Äúscore‚Äù
parameters that are unique to the Ordered Stereotype Model. The first
and the last values are fixed as 0 and 1.</p>
<p>The values of the remaining coefficients are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>œï</mi><mn>2</mn></msub><mo>=</mo><mn>0.13</mn></mrow><annotation encoding="application/x-tex">\phi_2 = 0.13</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>œï</mi><mn>3</mn></msub><mo>=</mo><mn>0.18</mn></mrow><annotation encoding="application/x-tex">\phi_3 = 0.18</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>œï</mi><mn>4</mn></msub><mo>=</mo><mn>0.60</mn></mrow><annotation encoding="application/x-tex">\phi_4 = 0.60</annotation></semantics></math>.</p>
<p>Note firstly that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œï</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\phi_2</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œï</mi><mn>3</mn></msub><annotation encoding="application/x-tex">\phi_3</annotation></semantics></math>
have very similar estimated values. The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œï</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\phi_k</annotation></semantics></math>
values modify the effects of the covariates so that they have slightly
different effects for each level. Since
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œï</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\phi_2</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œï</mi><mn>3</mn></msub><annotation encoding="application/x-tex">\phi_3</annotation></semantics></math>
are very similar, covariates have similar effects on both of those
levels. Roughly speaking, this means that if the baseline pushes up the
chances of getting level 2 scores compared to the reference level 1, the
baseline will also push up the chances of getting level 3 scores
compared to the reference level 1. There‚Äôs very little difference in the
pattern of the results for response level 2 compared to response level
3.</p>
<p>That tells us that if we want to simplify the scores we could merge
levels 2 and 3 without changing the information in the results much.
Let‚Äôs try that.</p>
<div class="section level4">
<h4 id="merging-response-levels">Merging response levels<a class="anchor" aria-label="anchor" href="#merging-response-levels"></a>
</h4>
<p>We start by constructing a new version of the response with both of
those levels converted to level ‚Äú2.5‚Äù and defining that as a new
factor:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">arthritis</span><span class="op">$</span><span class="va">y_merged</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">arthritis</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">arthritis</span><span class="op">$</span><span class="va">y_merged</span><span class="op">[</span><span class="va">arthritis</span><span class="op">$</span><span class="va">y_merged</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2.5</span></span>
<span><span class="va">arthritis</span><span class="op">$</span><span class="va">y_merged</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">arthritis</span><span class="op">$</span><span class="va">y_merged</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_merged</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/osm.html">osm</a></span><span class="op">(</span><span class="va">y_merged</span> <span class="op">~</span> <span class="va">baseline</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span>, data<span class="op">=</span><span class="va">arthritis</span>, </span>
<span>                  subset <span class="op">=</span> <span class="op">(</span><span class="va">time</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxit <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit_merged</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; osm(formula = y_merged ~ baseline + sex + age, data = arthritis, </span></span>
<span><span class="co">#&gt;     control = list(maxit = 5000), subset = (time == 1))</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients beta:</span></span>
<span><span class="co">#&gt;    baseline         sex         age </span></span>
<span><span class="co">#&gt;  1.84434169  0.79653858 -0.02462713 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts mu:</span></span>
<span><span class="co">#&gt;       mu1     mu2.5       mu4       mu5 </span></span>
<span><span class="co">#&gt;  0.000000  2.095391 -1.106147 -5.627979 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Score parameters phi:</span></span>
<span><span class="co">#&gt;      phi1    phi2.5      phi4      phi5 </span></span>
<span><span class="co">#&gt; 0.0000000 0.1457573 0.6098663 1.0000000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual Deviance: 510.7324 </span></span>
<span><span class="co">#&gt; AIC: 526.7324 </span></span>
<span><span class="co">#&gt; BIC: 556.336 </span></span>
<span><span class="co">#&gt; (3 observations deleted due to missingness)</span></span></code></pre></div>
<p>As you can see, the coefficient estimates for the covariates have
changed a little, but the general pattern is the same, because levels 2
and 3 were not giving us much different information about the covariates
anyway.</p>
<p>If we wanted to simplify the data even further we could consider
merging response levels 1 and 2.5, which are still fairly close
together, but that‚Äôs probably unnecessary.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œï</mi><mn>4</mn></msub><annotation encoding="application/x-tex">\phi_4</annotation></semantics></math>
is very different to both
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œï</mi><mn>2.5</mn></msub><annotation encoding="application/x-tex">\phi_{2.5}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œï</mi><mn>5</mn></msub><annotation encoding="application/x-tex">\phi_5</annotation></semantics></math>,
so that suggests those three levels are all useful for understanding the
effects of the covariates, so we should not merge them.</p>
<p>Generally speaking, we would consider any difference between
consecutive
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œï</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\phi_k</annotation></semantics></math>
values that‚Äôs smaller than 0.1 to be a small difference, any difference
between 0.1 and 0.2 to be a fairly small difference and any difference
above 0.2 to be a large difference. Levels with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œï</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\phi_k</annotation></semantics></math>
values more than 0.2 apart should not be merged.</p>
<p>If we merged levels 4 and 5 we‚Äôd expect the results to change a
lot:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">arthritis</span><span class="op">$</span><span class="va">y_merged2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">arthritis</span><span class="op">$</span><span class="va">y_merged</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">arthritis</span><span class="op">$</span><span class="va">y_merged2</span><span class="op">[</span><span class="va">arthritis</span><span class="op">$</span><span class="va">y_merged2</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">4.5</span></span>
<span><span class="va">arthritis</span><span class="op">$</span><span class="va">y_merged2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">arthritis</span><span class="op">$</span><span class="va">y_merged2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_merged2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/osm.html">osm</a></span><span class="op">(</span><span class="va">y_merged2</span> <span class="op">~</span> <span class="va">baseline</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span>, data<span class="op">=</span><span class="va">arthritis</span>, </span>
<span>                   subset <span class="op">=</span> <span class="op">(</span><span class="va">time</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxit <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit_merged2</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; osm(formula = y_merged2 ~ baseline + sex + age, data = arthritis, </span></span>
<span><span class="co">#&gt;     control = list(maxit = 5000), subset = (time == 1))</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients beta:</span></span>
<span><span class="co">#&gt;    baseline         sex         age </span></span>
<span><span class="co">#&gt;  1.19341708  0.60296382 -0.00908178 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts mu:</span></span>
<span><span class="co">#&gt;       mu1     mu2.5     mu4.5 </span></span>
<span><span class="co">#&gt;  0.000000  2.031736 -1.714161 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Score parameters phi:</span></span>
<span><span class="co">#&gt;      phi1    phi2.5    phi4.5 </span></span>
<span><span class="co">#&gt; 0.0000000 0.2106618 1.0000000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual Deviance: 430.9072 </span></span>
<span><span class="co">#&gt; AIC: 442.9072 </span></span>
<span><span class="co">#&gt; BIC: 465.1099 </span></span>
<span><span class="co">#&gt; (3 observations deleted due to missingness)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="recoding-the-response-levels-using-the-score-parameters">Recoding the response levels using the score parameters<a class="anchor" aria-label="anchor" href="#recoding-the-response-levels-using-the-score-parameters"></a>
</h4>
<p>The other useful aspect of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œï</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\phi_k</annotation></semantics></math>
parameters, apart from an indication of which levels of the response
could be merged without much loss of information, is that they can be
used to recode the ordinal levels in an empirical way.</p>
<p>That is, if you want to apply numerical methods to the ordinal
response variable, then instead of numbering the levels 1, 2, etc. you
can number them using the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œï</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\phi_k</annotation></semantics></math>
values, which are empirically selected based on the data. If you wish,
you can rescale the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œï</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\phi_k</annotation></semantics></math>
values so that the levels range between 1 and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi><annotation encoding="application/x-tex">q</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi><annotation encoding="application/x-tex">q</annotation></semantics></math>
is the total number of levels in the response. You simply calculate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>k</mi></msub><mo>=</mo><mn>1</mn><mo>+</mo><msub><mi>œï</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>q</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">v_k = 1 + \phi_k (q-1)</annotation></semantics></math>
and then the values
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>v</mi><mi>k</mi></msub><annotation encoding="application/x-tex">v_k</annotation></semantics></math>
will be your new codings for the response levels.</p>
<p>Fern√°ndez, et al.¬†(2021) demonstrates a similar approach where the
ordered stereotype scores are used as codings for the response levels
before applying a numerical method, archetypoid analysis, to the recoded
responses. However, as that is a multivariate analysis method, in that
particular case the clustering form of the ordered stereotype model was
fitted, instead of the regression model.</p>
<p>Note that this recoding is merely a suggestion from the data, not a
requirement. If there are good <em>a priori</em> reasons for keeping the
response levels unmerged, such as wanting to retain consistency with an
analysis on another related dataset, then there is no need to merge the
levels. The results simply indicate which levels could be safely merged
if merging is desirable.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="odds-ratios">Odds ratios<a class="anchor" aria-label="anchor" href="#odds-ratios"></a>
</h2>
<p>In the Ordered Stereotype Model, it is not possible to calculate a
single odds ratio estimate for each covariate coefficient. This is
because the model is purposely constructed so that the covariates can
have slightly different effects on the different levels of the response
variable. The overall effect of a covariate depends not only on its
coefficient but also on the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œï</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\phi_k</annotation></semantics></math>
parameter for each level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
of the response.</p>
<p>The implication of that is that there is no single number, akin to an
odds ratio, that would summarize how the covariate changes the response.
We can say which effect sizes are bigger and smaller, and which are
positive and negative, but there is no convenient way to summarize the
differences caused by a covariate using one single number.</p>
</div>
<div class="section level2">
<h2 id="stereotype-model-functions-in-other-packages">Stereotype Model functions in other packages<a class="anchor" aria-label="anchor" href="#stereotype-model-functions-in-other-packages"></a>
</h2>
<p>Note that the <code>ordinalgmifs</code> package also provides a
fitting function for the Stereotype Model. However, this package fits
the Stereotype Model rather than the Ordered Stereotype Model.</p>
<p>The Ordered Stereotype Model has a restriction
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>=</mo><msub><mi>œï</mi><mn>1</mn></msub><mo>‚â§</mo><msub><mi>œï</mi><mn>2</mn></msub><mo>‚â§</mo><mi>‚Ä¶</mi><mo>‚â§</mo><msub><mi>œï</mi><mi>q</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 = \phi_1 \leq \phi_2 \leq \dots \leq \phi_q = 1</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi><annotation encoding="application/x-tex">q</annotation></semantics></math>
is the number of levels in the response variable, and this restriction
enforces the ordinal nature of the response.</p>
<p>The Stereotype Model, i.e.¬†the model fitted in
<code>ordinalgmifs</code>, does not have this restriction on the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œï</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\phi_k</annotation></semantics></math>
values.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Fern√°ndez, D., Epifanio, I. and McMillan, L. F. (2021) Archetypal
analysis for ordinal data. <em>Information Sciences</em>, 579,
pp.¬†281‚Äì292, <a href="https://doi.org/10.1016/j.ins.2021.07.095" class="external-link uri">https://doi.org/10.1016/j.ins.2021.07.095</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Louise McMillan, Daniel Fern√°ndez Mart√≠nez, Ying Cui, Eleni Matechou.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
